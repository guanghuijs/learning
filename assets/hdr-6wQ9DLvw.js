import{D as z,H as L,k,l as I,m as T,n as f,S as x,P as Y,W as $,E as O,O as j}from"./OrbitControls-D_oMNle7.js";import{b as U}from"./route-block-B_A1xBdJ.js";import{_ as q,o as X,n as Q,b as J}from"./index-BtQ9Oy6z.js";class K extends z{constructor(d){super(d),this.type=L}parse(d){const c=function(e,n){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(n||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(n||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(n||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(n||""))}return-1},A=function(e,n,s){n=n||1024;let l=e.pos,o=-1,r=0,i="",a=String.fromCharCode.apply(null,new Uint16Array(e.subarray(l,l+128)));for(;0>(o=a.indexOf(`
`))&&r<n&&l<e.byteLength;)i+=a,r+=a.length,l+=128,a+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(l,l+128)));return-1<o?(e.pos+=r+o+1,i+a.slice(0,o)):!1},v=function(e){const n=/^#\?(\S+)/,s=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,t=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,l=/^\s*FORMAT=(\S+)\s*$/,o=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,r={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let i,a;if(e.pos>=e.byteLength||!(i=A(e)))return c(1,"no header found");if(!(a=i.match(n)))return c(3,"bad initial token");for(r.valid|=1,r.programtype=a[1],r.string+=i+`
`;i=A(e),i!==!1;){if(r.string+=i+`
`,i.charAt(0)==="#"){r.comments+=i+`
`;continue}if((a=i.match(s))&&(r.gamma=parseFloat(a[1])),(a=i.match(t))&&(r.exposure=parseFloat(a[1])),(a=i.match(l))&&(r.valid|=2,r.format=a[1]),(a=i.match(o))&&(r.valid|=4,r.height=parseInt(a[1],10),r.width=parseInt(a[2],10)),r.valid&2&&r.valid&4)break}return r.valid&2?r.valid&4?r:c(3,"missing image size specifier"):c(3,"missing format specifier")},V=function(e,n,s){const t=n;if(t<8||t>32767||e[0]!==2||e[1]!==2||e[2]&128)return new Uint8Array(e);if(t!==(e[2]<<8|e[3]))return c(3,"wrong scanline width");const l=new Uint8Array(4*n*s);if(!l.length)return c(4,"unable to allocate buffer space");let o=0,r=0;const i=4*t,a=new Uint8Array(4),m=new Uint8Array(i);let M=s;for(;M>0&&r<e.byteLength;){if(r+4>e.byteLength)return c(1);if(a[0]=e[r++],a[1]=e[r++],a[2]=e[r++],a[3]=e[r++],a[0]!=2||a[1]!=2||(a[2]<<8|a[3])!=t)return c(3,"bad rgbe scanline format");let w=0,p;for(;w<i&&r<e.byteLength;){p=e[r++];const h=p>128;if(h&&(p-=128),p===0||w+p>i)return c(3,"bad scanline data");if(h){const E=e[r++];for(let S=0;S<p;S++)m[w++]=E}else m.set(e.subarray(r,r+p),w),w+=p,r+=p}const W=t;for(let h=0;h<W;h++){let E=0;l[o]=m[h+E],E+=t,l[o+1]=m[h+E],E+=t,l[o+2]=m[h+E],E+=t,l[o+3]=m[h+E],o+=4}M--}return l},C=function(e,n,s,t){const l=e[n+3],o=Math.pow(2,l-128)/255;s[t+0]=e[n+0]*o,s[t+1]=e[n+1]*o,s[t+2]=e[n+2]*o,s[t+3]=1},P=function(e,n,s,t){const l=e[n+3],o=Math.pow(2,l-128)/255;s[t+0]=I.toHalfFloat(Math.min(e[n+0]*o,65504)),s[t+1]=I.toHalfFloat(Math.min(e[n+1]*o,65504)),s[t+2]=I.toHalfFloat(Math.min(e[n+2]*o,65504)),s[t+3]=I.toHalfFloat(1)},G=new Uint8Array(d);G.pos=0;const u=v(G);if(u!==-1){const e=u.width,n=u.height,s=V(G.subarray(G.pos),e,n);if(s!==-1){let t,l,o,r;switch(this.type){case k:r=s.length/4;const i=new Float32Array(r*4);for(let m=0;m<r;m++)C(s,m*4,i,m*4);t=i,o=k;break;case L:r=s.length/4;const a=new Uint16Array(r*4);for(let m=0;m<r;m++)P(s,m*4,a,m*4);t=a,o=L;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:e,height:n,data:t,header:u.string,gamma:u.gamma,exposure:u.exposure,format:l,type:o}}}return null}setDataType(d){return this.type=d,this}load(d,g,b,R){function y(_,c){switch(_.type){case k:_.encoding=T,_.minFilter=f,_.magFilter=f,_.generateMipmaps=!1,_.flipY=!0;break;case L:_.encoding=T,_.minFilter=f,_.magFilter=f,_.generateMipmaps=!1,_.flipY=!0;break}g&&g(_,c)}return super.load(d,y,b,R)}}const Z={className:"box"},D={__name:"hdr",setup(N){const d=new URL("/learning/assets/venice_sunset_1k.hdr-GQE-mhuc.hdr",import.meta.url);let g,b,R;const y=()=>{g=new x;const c=document.querySelector(".box");b=new Y(75,c.clientWidth/c.clientHeight),b.position.set(0,0,5),R=new $,R.setSize(c.clientWidth,c.clientHeight),new K().load(d,B=>{B.mapping=O,g.background=B,g.environment=B,_()});const F=()=>{_()};_(),new j(b,R.domElement).addEventListener("change",F),c.appendChild(R.domElement)},_=()=>{R.render(g,b)};return X(()=>{y()}),(c,F)=>(J(),Q("div",Z))}};typeof U=="function"&&U(D);const te=q(D,[["__scopeId","data-v-94413347"]]);export{te as default};

import{C as T,L as W,F as q,G as J,c as G,d as I,e as U,f as N,g as P,h as K,i as D,j as S,b as O,V as M,S as Q,A as X,P as Y,k as Z,W as $,l as ee,O as te}from"./OrbitControls-PK4fmBsq.js";import{_ as se,y as ne,o as ie,c as oe,a as z,p as re,l as ae}from"./index-WJebj2m3.js";const le=/^[og]\s*(.+)?/,ce=/^mtllib /,he=/^usemtl /,de=/^usemap /,H=new M,E=new M,R=new M,k=new M,j=new M,A=new T;function ue(){const w={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(s,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=s,this.object.fromDeclaration=t!==!1;return}const i=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:s||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,n){const a=this._finalize(!1);a&&(a.inherited||a.groupCount<=0)&&this.materials.splice(a.index,1);const d={index:this.materials.length,name:e||"",mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:a!==void 0?a.smooth:this.smooth,groupStart:a!==void 0?a.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(f){const u={index:typeof f=="number"?f:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return u.clone=this.clone.bind(u),u}};return this.materials.push(d),d},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),e&&this.materials.length>1)for(let a=this.materials.length-1;a>=0;a--)this.materials[a].groupCount<=0&&this.materials.splice(a,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}},i&&i.name&&typeof i.clone=="function"){const e=i.clone(0);e.inherited=!0,this.object.materials.push(e)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(s,t){const i=parseInt(s,10);return(i>=0?i-1:i+t/3)*3},parseNormalIndex:function(s,t){const i=parseInt(s,10);return(i>=0?i-1:i+t/3)*3},parseUVIndex:function(s,t){const i=parseInt(s,10);return(i>=0?i-1:i+t/2)*2},addVertex:function(s,t,i){const e=this.vertices,n=this.object.geometry.vertices;n.push(e[s+0],e[s+1],e[s+2]),n.push(e[t+0],e[t+1],e[t+2]),n.push(e[i+0],e[i+1],e[i+2])},addVertexPoint:function(s){const t=this.vertices;this.object.geometry.vertices.push(t[s+0],t[s+1],t[s+2])},addVertexLine:function(s){const t=this.vertices;this.object.geometry.vertices.push(t[s+0],t[s+1],t[s+2])},addNormal:function(s,t,i){const e=this.normals,n=this.object.geometry.normals;n.push(e[s+0],e[s+1],e[s+2]),n.push(e[t+0],e[t+1],e[t+2]),n.push(e[i+0],e[i+1],e[i+2])},addFaceNormal:function(s,t,i){const e=this.vertices,n=this.object.geometry.normals;H.fromArray(e,s),E.fromArray(e,t),R.fromArray(e,i),j.subVectors(R,E),k.subVectors(H,E),j.cross(k),j.normalize(),n.push(j.x,j.y,j.z),n.push(j.x,j.y,j.z),n.push(j.x,j.y,j.z)},addColor:function(s,t,i){const e=this.colors,n=this.object.geometry.colors;e[s]!==void 0&&n.push(e[s+0],e[s+1],e[s+2]),e[t]!==void 0&&n.push(e[t+0],e[t+1],e[t+2]),e[i]!==void 0&&n.push(e[i+0],e[i+1],e[i+2])},addUV:function(s,t,i){const e=this.uvs,n=this.object.geometry.uvs;n.push(e[s+0],e[s+1]),n.push(e[t+0],e[t+1]),n.push(e[i+0],e[i+1])},addDefaultUV:function(){const s=this.object.geometry.uvs;s.push(0,0),s.push(0,0),s.push(0,0)},addUVLine:function(s){const t=this.uvs;this.object.geometry.uvs.push(t[s+0],t[s+1])},addFace:function(s,t,i,e,n,a,d,f,u){const y=this.vertices.length;let l=this.parseVertexIndex(s,y),m=this.parseVertexIndex(t,y),o=this.parseVertexIndex(i,y);if(this.addVertex(l,m,o),this.addColor(l,m,o),d!==void 0&&d!==""){const r=this.normals.length;l=this.parseNormalIndex(d,r),m=this.parseNormalIndex(f,r),o=this.parseNormalIndex(u,r),this.addNormal(l,m,o)}else this.addFaceNormal(l,m,o);if(e!==void 0&&e!==""){const r=this.uvs.length;l=this.parseUVIndex(e,r),m=this.parseUVIndex(n,r),o=this.parseUVIndex(a,r),this.addUV(l,m,o),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(s){this.object.geometry.type="Points";const t=this.vertices.length;for(let i=0,e=s.length;i<e;i++){const n=this.parseVertexIndex(s[i],t);this.addVertexPoint(n),this.addColor(n)}},addLineGeometry:function(s,t){this.object.geometry.type="Line";const i=this.vertices.length,e=this.uvs.length;for(let n=0,a=s.length;n<a;n++)this.addVertexLine(this.parseVertexIndex(s[n],i));for(let n=0,a=t.length;n<a;n++)this.addUVLine(this.parseUVIndex(t[n],e))}};return w.startObject("",!1),w}class fe extends W{constructor(s){super(s),this.materials=null}load(s,t,i,e){const n=this,a=new q(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(s,function(d){try{t(n.parse(d))}catch(f){e?e(f):console.error(f),n.manager.itemError(s)}},i,e)}setMaterials(s){return this.materials=s,this}parse(s){const t=new ue;s.indexOf(`\r
`)!==-1&&(s=s.replace(/\r\n/g,`
`)),s.indexOf(`\\
`)!==-1&&(s=s.replace(/\\\n/g,""));const i=s.split(`
`);let e="",n="",a=0,d=[];const f=typeof"".trimLeft=="function";for(let l=0,m=i.length;l<m;l++)if(e=i[l],e=f?e.trimLeft():e.trim(),a=e.length,a!==0&&(n=e.charAt(0),n!=="#"))if(n==="v"){const o=e.split(/\s+/);switch(o[0]){case"v":t.vertices.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3])),o.length>=7?(A.setRGB(parseFloat(o[4]),parseFloat(o[5]),parseFloat(o[6])).convertSRGBToLinear(),t.colors.push(A.r,A.g,A.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]));break;case"vt":t.uvs.push(parseFloat(o[1]),parseFloat(o[2]));break}}else if(n==="f"){const r=e.slice(1).trim().split(/\s+/),b=[];for(let p=0,x=r.length;p<x;p++){const h=r[p];if(h.length>0){const g=h.split("/");b.push(g)}}const v=b[0];for(let p=1,x=b.length-1;p<x;p++){const h=b[p],g=b[p+1];t.addFace(v[0],h[0],g[0],v[1],h[1],g[1],v[2],h[2],g[2])}}else if(n==="l"){const o=e.substring(1).trim().split(" ");let r=[];const b=[];if(e.indexOf("/")===-1)r=o;else for(let v=0,p=o.length;v<p;v++){const x=o[v].split("/");x[0]!==""&&r.push(x[0]),x[1]!==""&&b.push(x[1])}t.addLineGeometry(r,b)}else if(n==="p"){const r=e.slice(1).trim().split(" ");t.addPointGeometry(r)}else if((d=le.exec(e))!==null){const o=(" "+d[0].slice(1).trim()).slice(1);t.startObject(o)}else if(he.test(e))t.object.startMaterial(e.substring(7).trim(),t.materialLibraries);else if(ce.test(e))t.materialLibraries.push(e.substring(7).trim());else if(de.test(e))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(n==="s"){if(d=e.split(" "),d.length>1){const r=d[1].trim().toLowerCase();t.object.smooth=r!=="0"&&r!=="off"}else t.object.smooth=!0;const o=t.object.currentMaterial();o&&(o.smooth=t.object.smooth)}else{if(e==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+e+'"')}t.finalize();const u=new J;if(u.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let l=0,m=t.objects.length;l<m;l++){const o=t.objects[l],r=o.geometry,b=o.materials,v=r.type==="Line",p=r.type==="Points";let x=!1;if(r.vertices.length===0)continue;const h=new G;h.setAttribute("position",new I(r.vertices,3)),r.normals.length>0&&h.setAttribute("normal",new I(r.normals,3)),r.colors.length>0&&(x=!0,h.setAttribute("color",new I(r.colors,3))),r.hasUVIndices===!0&&h.setAttribute("uv",new I(r.uvs,2));const g=[];for(let L=0,F=b.length;L<F;L++){const V=b[L],B=V.name+"_"+V.smooth+"_"+x;let c=t.materials[B];if(this.materials!==null){if(c=this.materials.create(V.name),v&&c&&!(c instanceof U)){const C=new U;N.prototype.copy.call(C,c),C.color.copy(c.color),c=C}else if(p&&c&&!(c instanceof P)){const C=new P({size:10,sizeAttenuation:!1});N.prototype.copy.call(C,c),C.color.copy(c.color),C.map=c.map,c=C}}c===void 0&&(v?c=new U:p?c=new P({size:1,sizeAttenuation:!1}):c=new K,c.name=V.name,c.flatShading=!V.smooth,c.vertexColors=x,t.materials[B]=c),g.push(c)}let _;if(g.length>1){for(let L=0,F=b.length;L<F;L++){const V=b[L];h.addGroup(V.groupStart,V.groupCount,L)}v?_=new D(h,g):p?_=new S(h,g):_=new O(h,g)}else v?_=new D(h,g[0]):p?_=new S(h,g[0]):_=new O(h,g[0]);_.name=o.name,u.add(_)}else if(t.vertices.length>0){const l=new P({size:1,sizeAttenuation:!1}),m=new G;m.setAttribute("position",new I(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(m.setAttribute("color",new I(t.colors,3)),l.vertexColors=!0);const o=new S(m,l);u.add(o)}return u}}const me=w=>(re("data-v-9d2168ba"),w=w(),ae(),w),pe={className:"box"},ge={className:"option-container"},be={className:"flex-between"},ve=me(()=>z("span",null,"渲染器背景色:",-1)),xe={__name:"obj",setup(w){let s,t,i,e,n;const a=()=>{s=new Q,s.add(new X(10066329)),e=document.querySelector(".box"),t=new Y(35,e.clientWidth/e.clientHeight,1,500),t.up.set(0,0,1),t.position.set(0,-9,6),t.add(new Z(16777215,1)),s.add(t),i=new $({antialias:!0}),i.setSize(e.clientWidth,e.clientHeight);const u=new ee(50,50,11184810,5592405);u.rotateOnAxis(new M(1,0,0),90*(Math.PI/180)),s.add(u),i.setClearColor("#f2f2f2"),e.appendChild(i.domElement),new fe().load("/models/obj/maya2.obj",l=>{l.name="objTest",l.position.set(0,0,2),l.rotation.y=Math.PI/4,s.add(l),f()});const y=()=>{f()};y(),f(),n=new te(t,i.domElement),n.addEventListener("change",y),e.appendChild(i.domElement)},d=u=>{i.setClearColor(u.target.value),f()},f=()=>{i.render(s,t)};return ne(()=>{a(),f()}),(u,y)=>(ie(),oe("div",pe,[z("div",ge,[z("div",be,[ve,z("input",{onInput:y[0]||(y[0]=l=>d(l)),value:"#000000",type:"color"},null,32)])])]))}},we=se(xe,[["__scopeId","data-v-9d2168ba"]]);export{we as default};
